import { ArgsTable, Meta, Story, Canvas } from "@storybook/addon-docs";
import { AutocompleteSearchBox } from "../AutocompleteSearchBox";
import * as stories from "./AutocompleteSearchBox.stories";

<Meta title="Components/AutocompleteSearchBox" component={AutocompleteSearchBox} />

# AutocompleteSearchBox

The autocomplete searchbox is a component that expands on the Fluent UI React Searchox with an autocomplete dropdown.
The component is inspired and built upon the Microsoft example: [https://github.com/microsoft/autocomplete-search-box]()
When typing in the searchbox, autocomplete suggestions are dynamically fetched and displayed in a dropdown below the searchbox.

### Basic usage

This example shows the basic usage of the AutocompleteSearchBox component.
The only required property is an `onResolveSuggestions` function that returns a promise with the suggestions.

<Canvas withToolbar={true}>
	<Story story={stories.Basic} name="Basic usage" />
</Canvas>

### With delay

An option is available to add a delay on the suggestion resolving.
This can be useful if the suggestions are fetched from a remote server and you want to avoid making too many requests.
When the `resolveDelay` property is set, the suggestions will only be resolved after the specified delay when typing stopped.

<Canvas withToolbar={true}>
	<Story story={stories.WithDelay} name="With delay" />
</Canvas>

### With callout properties

It is possible to override the callout properties by using the `calloutProps` property and the `calloutTitle` properties.
This can be useful if you want to customize the callout appearance or add a title to the callout.

<Canvas withToolbar={true}>
	<Story story={stories.WithCalloutProperties} name="With callout properties" />
</Canvas>

### Suggestion highlighting

By default, the suggestions are highlighted in the dropdown based on the search text.
This can be disabled by setting the `withSuggestionHighlighting` property to `false`.

<Canvas withToolbar={true}>
	<Story story={stories.SuggestionHighlighting} name="Suggestion highlighting" />
</Canvas>

### Focus resolve suggestions

Suggestion are resolved when typing in the searchbox.
However, it is also possible to resolve suggestions when the searchbox is focused using the `onFocusResolveSuggestions` property.

<Canvas withToolbar={true}>
	<Story story={stories.FocusResolveSuggestions} name="Focus resolve suggestions" />
</Canvas>

### Aborting resolve suggestions

Internally, the component uses a `AbortController` to abort the resolve suggestions when typing in the searchbox.
For this, the `AbortSignal` is passed to the `onResolveSuggestions` function so that it can be passed to a fetch request.

<Canvas withToolbar={true}>
	<Story story={stories.Aborting} name="Aborting resolve suggestions" />
</Canvas>

### Custom suggestion render

There is an option to customize the suggestion rendering by using the `onRenderSuggestion` property.
The `onRenderSuggestion` function receives the suggestion and a default render function as arguments and should return a React element.

<Canvas withToolbar={true}>
	<Story story={stories.CustomSuggestionRender} name="Custom suggestion render" />
</Canvas>

### Custom suggestion object

TODO

<Canvas withToolbar={true}>
	<Story story={stories.CustomSuggestionObject} name="Custom suggestion object" />
</Canvas>

### Custom Styles

The example below show custom styling options

<Canvas withToolbar={true}>
	<Story story={stories.CustomStyling} name="Custom Styling" />
</Canvas>
